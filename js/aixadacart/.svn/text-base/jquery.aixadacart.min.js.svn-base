(function(e){var d={init:function(g){var h={loadCartURL:"ctrlShopAndOrder.php",saveCartURL:"ctrlShopAndOrder.php",date:0,preOrder:false,cartType:"standalone",ajaxType:"POST",btnType:"submit",beforeSubmit:function(){},submitSuccess:function(){},submitError:function(i){},submitComplete:function(){},loadSuccess:function(){}};return this.each(function(){var i=e(this);if(g){e.extend(h,g)}data=i.data("aixadacart");if(!data){e(this).data("aixadacart",{loadCartURL:h.loadCartURL,saveCartURL:h.saveCartURL,date:h.date,preOrder:h.preOrder,cartType:h.cartType,ajaxType:h.ajaxType,btnType:h.btnType,beforeSubmit:h.beforeSubmit,submitSuccess:h.submitSuccess,submitError:h.submitError,submitComplete:h.submitComplete,loadSuccess:h.loadSuccess})}b.call(i);f.call(i,i.data("aixadacart").cartType);if(i.data("aixadacart").cartType=="standalone_preorder"){e("#cart_tabs").tabs()}if(i.data("aixadacart").btnType=="validate"){e("#btn_submit").button({disabled:true,icons:{secondary:"ui-icon-check"},label:e.aixadacart.validate})}else{if(i.data("aixadacart").btnType=="save"){e("#btn_submit").button({disabled:true,icons:{secondary:"ui-icon-disk"},label:e.aixadacart.save})}else{e("#btn_submit").button({disabled:true,label:e.aixadacart.submit})}}e("form",this).submit(function(){i.data("aixadacart").beforeSubmit.call(i);e("#btn_submit").button("option","disabled",true);var j=e(this).serialize();e.ajax({type:i.data("aixadacart").ajaxType,url:i.data("aixadacart").saveCartURL,data:j,beforeSend:function(){},success:function(k){i.data("aixadacart").submitSuccess.call(i)},error:function(k,m,l){i.data("aixadacart").submitError.call(i,m);e("#cart_dialog").html(l).dialog("option","title","Saving cart error").dialog("open")},complete:function(k){e("#btn_submit").button("option","disabled",false);i.data("aixadacart").submitComplete.call(i)}});return false})})},addItem:function(g){return this.each(function(){if(g.isPreorder=="true"||g.isPreorder==1){var i=e("#aixada_cart_list_preorder")}else{var i=e("#aixada_cart_list")}var h=e("#cart_quantity_"+g.id,i).val();if(!h){var j='<tr id="'+g.id+'">';j+='<td><span id="del_'+g.id+'" class="ui-icon ui-icon-trash"></span></td>';j+='<td class="item_name">'+g.name+"</td>";j+='<td class="item_quantity">	 <input name="quantity[]" value="'+g.quantity+'" id="cart_quantity_'+g.id+'" size="4" />';j+='<input type="hidden" name="preorder[]" value="'+g.isPreorder+'" id="preorder_'+g.id+'" />';j+='<input type="hidden" name="price[]" value="'+g.price+'" id="cart_price_'+g.id+'" />';j+='<input type="hidden" name="product_id[]" value="'+g.id+'" />';j+='<input type="hidden" name="rev_tax_factor[]" value="'+g.rev_tax_factor+'" id="cart_rev_tax_factor_'+g.id+'" /></td>';j+="<td>"+g.unit+"</td>";j+='<td class="item_total" id="item_total_'+g.id+'"></td>';j+="</tr>";i.append(j);e("#del_"+g.id,i).bind("click",function(k){e(this).parents("tr").find("input").val(0).trigger("change").end().remove()});e("#cart_quantity_"+g.id,i).bind("change",function(k){var l=i.aixadacart("getRowData",{type:"table",row:e(this).parents("tr")});c.call(e(this),l);e("#quantity_"+l.id).val(l.quantity.toFixed(2));a.call()})}else{e("#cart_quantity_"+g.id,i).val(g.quantity.toFixed(2))}c.call(i,g);e("#btn_submit").button("option","disabled",false)})},options:function(g){return this.each(function(){data=e(this).data("aixadacart");if(data.date!=g.date){e(this).aixadacart("setDate",g.date)}if(g){e.extend(data,g)}})},setDate:function(g){return this.each(function(){e(this).data("aixadacart").date=g;e("#cart_date",e(this)).val(g);e(this).aixadacart("removeAll")})},loadCart:function(g){return this.each(function(){var h=e(this);if(g.saveCartURL){e("#cart_dialog").html("Should not change the save cart URL while loading!").dialog("option","title","Warning").dialog("open")}h.aixadacart("options",g);e.ajax({type:"GET",url:h.data("aixadacart").loadCartURL,dataType:"xml",success:function(i){e(i).find("row").each(function(){var j=h.aixadacart("getRowData",{type:"xml",row:e(this)});h.aixadacart("addItem",j)});h.data("aixadacart").loadSuccess.call(this)},error:function(i,k,j){e("#cart_dialog").html(k+" for the following URL: "+h.("aixadacart").loadCartURL).dialog("option","title","Load Cart Error").dialog("open")}})})},destroy:function(){return this.each(function(){data=e(this).data("aixadacart");e(window).unbind(".aixadacart");data.aixadacart.remove();e(this).removeData("aixadacart")})},removeItem:function(g){return this.each(function(){e("tr[id="+g+"]",this).find("input").val(0).trigger("change").end().remove()})},resetCart:function(){return this.each(function(){e(this).aixadacart("setDate",0)})},removeAll:function(){return this.each(function(){e("#aixada_cart_list tbody tr").empty().remove();a.call();e("#btn_submit").button("option","disabled",true)})},getRowData:function(g){var j;if(g.type=="xml"){var h=g.row;j={id:e(h).find("id").text(),isPreorder:e(h).find("preorder").text(),name:e(h).find("name").text(),quantity:parseFloat(e(h).find("quantity").text()),unit:e(h).find("unit_measure_id_order").text(),price:parseFloat(e(h).find("unit_price").text()),rev_tax_factor:parseFloat(e(h).find("rev_tax_factor").text())}}else{if(g.type=="table"){var h=g.row;var i=e(h).attr("id");j={id:i,isPreorder:e("#preorder_"+i).val(),name:e("td.item_name",h).text(),quantity:parseFloat(e("#cart_quantity_"+i).val()),unit:e("td.item_unit",h).text(),price:parseFloat(e("#cart_price_"+i,h).val()),rev_tax_factor:parseFloat(e("#cart_rev_tax_factor_"+i,h).val()),}}}return j}};function c(i){$this=e("#aixada_cart_list");var g=parseFloat(e("td.subtotal",$this).text());g=isNaN(g)?0:g;var l=parseFloat(e("td.rev_tax_total",$this).text());l=isNaN(l)?0:l;var j=parseFloat(e("td.total",$this).text());j=isNaN(j)?0:j;var h=i.price*i.quantity;var k=(h*i.rev_tax_factor)/100;g+=h;h+=k;l+=k;j=g+l;e("#cart_quantity_"+i.id).val(i.quantity.toFixed(2));e("#item_total_"+i.id).text(String(h.toFixed(2)));if(i.isPreorder){return}e("td.subtotal",$this).text(String(g.toFixed(2)));e("td.rev_tax_total",$this).text(String(l.toFixed(2)));e("td.total",$this).text(String(j.toFixed(2)))}function a(){var h=0;var g=0;var i=0;e("#aixada_cart_list tbody tr").each(function(){var o=e(this).attr("id");var n=parseFloat(e("#cart_quantity_"+o,e(this)).val());var l=parseFloat(e("#cart_price_"+o,e(this)).val());var j=parseFloat(e("#cart_rev_tax_factor_"+o,e(this)).val());var k=l*n;var m=(k*j)/100;g+=k;i+=m;h=g+i});e("#aixada_cart_list td.subtotal").text(String(g.toFixed(2)));e("#aixada_cart_list td.rev_tax_total").text(String(i.toFixed(2)));e("#aixada_cart_list td.total").text(String(h.toFixed(2)))}function b(){e(this).append('<div id="cart_dialog"></div>');e("#cart_dialog").dialog({autoOpen:false,buttons:{Ok:function(){e(this).dialog("close")}}})}function f(j){var i="";var h="<thead>";h+="<tr>";h+="	<th></th>";h+="	<th>"+e.aixadacart.tblCol.productName+"</th>";h+="	<th>"+e.aixadacart.tblCol.quantityAbbrev+"</th>";h+="	<th>"+e.aixadacart.tblCol.unit+"</th>";h+="	<th>"+e.aixadacart.total+"</th>";h+="</tr>";h+="</thead>";var g="<tfoot>";g+='		<tr><td colspan="3">&nbsp;</td><td class="subtotal_label">'+e.aixadacart.total+'</td><td class="subtotal">0.00</td></tr>';g+='		<tr><td colspan="3">&nbsp;</td><td class="rev_tax_label">+'+e.aixadacart.revTaxAbbrev+'</td><td class="rev_tax_total">0.00</td></tr>';g+='		<tr><td colspan="3">&nbsp;</td><td class="total_label">'+e.aixadacart.total+'</td><td class="total">0.00</td></tr>';g+='		<tr><td colspan="5"><input type="submit" id="btn_submit" value="'+e.aixadacart.submit+'"/></td></tr>';g+="	</tfoot>";if(j=="simple"){i+='<form id="cart">';i+='<input type="hidden" name="date" id="cart_date" value="0" />';i+='<table id="aixada_cart_list" class="cart_product_list">';i+=h;i+="<tbody></tbody>";i+=g;i+="</table>";i+="</form>"}else{if(j=="standalone_preorder"){i+='<div id="aixada_cart_standalone_preorder" class="ui-widget">';i+='<form id="cart">';i+='<input type="hidden" name="date" id="cart_date" value="0" />';i+='<div id="cart_tabs">';i+="<ul>";i+='<li><a href="#tabsx-1" style="font-size:1.6em;">'+e.aixadacart.title.order+"</a></li>";i+='<li><a href="#tabsx-2" style="padding:1.20em;">'+e.aixadacart.title.preorder+"</a></li>";i+="</ul>";i+='<div id="tabsx-1">';i+='	<table id="aixada_cart_list" class="cart_product_list">';i+=h;i+="	<tbody></tbody>";i+=g;i+="</table>";i+="</div>";i+='<div id="tabsx-2">';i+='		<table id="aixada_cart_list_preorder" class="cart_product_list">';i+=h;i+="		<tbody></tbody>";i+="</table>";i+="</div></div></form></div>"}else{i+='<div id="aixada_cart_standalone" class="ui-widget">';i+='<form id="cart">';i+='<input type="hidden" name="date" id="cart_date" value="0" />';i+='<div class="cart_container ui-widget-content ui-corner-all">';i+='<h2 class="ui-widget-header ui-corner-all"> '+e.aixadacart.title.shop+"</h2>";i+='<table id="aixada_cart_list" class="cart_product_list">';i+=h;i+="	<tbody></tbody>";i+=g;i+="</table>";i+="</div>";i+="</form></div>"}}e(this).append(i)}e.fn.aixadacart=function(g){if(d[g]){return d[g].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof g==="object"||!g){return d.init.apply(this,arguments)}else{e.error("Method "+g+" does not exist on jQuery.aixadacart")}}}})(jQuery);